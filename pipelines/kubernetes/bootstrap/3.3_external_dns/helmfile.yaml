---

helmDefaults:
  verify: false
  wait: true
  timeout: 120
  historyMax: 5

repositories:
  - name: bitnami
    url: https://charts.bitnami.com/bitnami

releases:
  - name: external-dns
    namespace: {{ requiredEnv "NAMESPACE" }}
    chart: bitnami/external-dns
    version: 6.10.2
    values:
      - sources:
          - ingress
        provider: rfc2136
        rfc2136:
          host: centos7.internal
          zone: internal
          tsigKeyname: kube-cluster.internal.
          tsigSecret: {{ requiredEnv "TSIG_SECRET" }}
          minTTL: 30s
        interval: 15s
        txtOwnerId: Kubernetes
        rbac:
          create: true
          serviceAccountName: external-dns
        domainFilters:
          - internal
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true
          capabilities:
            drop: ["ALL"]
        podSecurityContext:
          runAsNonRoot: true
        resources:
          requests:
            memory: "45Mi"
            cpu: "10m"
          limits:
            memory: "45Mi"
            cpu: "50m"
