---

helmDefaults:
  verify: false
  wait: true
  timeout: 120
  recreatePods: true

releases:
  - name: metrics-server
    namespace: {{ requiredEnv "NAMESPACE" }}
    chart: stable/metrics-server
    version: 2.8.8
    values:
      - image:
          pullPolicy: Always
        args:
          - --kubelet-insecure-tls
          - --v=2
        rbac:
          pspEnabled: true
        podDisruptionBudget:
          enabled: true
          minAvailable: 1
        resources:
          requests:
            memory: "64Mi"
            cpu: "100m"
          limits:
            memory: "64Mi"
            cpu: "100m"
        service:
          labels:
            kubernetes.io/cluster-service: "true"
            kubernetes.io/name: metrics-server
