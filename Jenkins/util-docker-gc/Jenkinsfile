@Library('global-shared-library') _

import jenkins.model.Jenkins

@NonCPS
def nodeNames() {
  def nodes = []
  jenkins.model.Jenkins.instance.computers.each { c ->
    node = c.getNode()
    if (node.getChannel() != null && node.getNumExecutors() > 1) {
      nodes.add(node.getDisplayName())
    }
  }
  return nodes
}

nodes = [
  'Jenkins',
  'jenkins-slave',
  'jenkins-slave2'
]

node() {
  properties([
    buildDiscarder(logRotator(artifactDaysToKeepStr: '', numToKeepStr: '10')),
    pipelineTriggers([cron("TZ=Europe/London\nH H/6 * * *")])
  ])
}

nodes.each { node ->
  cleanupDocker(node)
}
